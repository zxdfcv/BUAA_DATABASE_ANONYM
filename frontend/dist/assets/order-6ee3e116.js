import{W as Q,X as Z,Y as ee,a4 as te,d as ae,A as oe,a as w,r as b,b as d,o as M,n as R,g as v,f as t,e as n,j as c,C as ne,i as l,M as f,p as le,k as se}from"./index-e9b87848.js";import{e as re}from"./exportCsv-f7ca4da5.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";const ie=async i=>Q({url:"/myapp/admin/order/list",params:i,data:{},headers:{}}),ce=async i=>Z({url:"/myapp/admin/order/create",params:{},data:i,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),me=async(i,y)=>ee({url:"/myapp/admin/order/update",params:i,data:y,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),H=async i=>te({url:"/myapp/admin/order/delete",params:i,headers:{}}),ue=i=>(le("data-v-db046c91"),i=i(),se(),i),pe={class:"page-view"},_e={class:"table-operations"},fe={key:0},ve=["onClick"],ge=ue(()=>v("a",{href:"#"},"删除",-1)),ye={style:{"padding-right":"16px","max-height":"480px","overflow-x":"hidden","overflow-y":"auto"}},he=ae({__name:"order",setup(i){oe(()=>{_()});const y=()=>{_()},F=o=>{var e;s.keyword=(e=o==null?void 0:o.target)==null?void 0:e.value,console.log(s.keyword)},K=w([{title:"序号",dataIndex:"id",key:"id",align:"center"},{title:"订单号",dataIndex:"order_number",key:"order_number",align:"center"},{title:"卖家",dataIndex:"merchant_name",key:"merchant_name",align:"center"},{title:"买家",dataIndex:"receiver_name",key:"receiver_name",align:"center"},{title:"商品",dataIndex:"product_name",key:"product_name",align:"center"},{title:"状态",dataIndex:"status",key:"status",align:"center",scopedSlots:{customRender:"status"}},{title:"创建时间",dataIndex:"create_time",key:"create_time",align:"center"},{title:"支付时间",dataIndex:"pay_time",key:"pay_time",align:"center"},{title:"金额",dataIndex:"amount",key:"amount",align:"center"},{title:"操作",dataIndex:"action",key:"operation",align:"center",fixed:"right",width:140}]),U=b(!1),s=w({dataList:[],loading:!1,keyword:"",selectedRowKeys:[],pageSize:10,page:1}),a=w({visile:!1,editFlag:!1,title:"",form:{id:void 0,merchant:void 0,receiver:void 0,product:void 0,status:void 0,pay_time:void 0,create_time:void 0,amount:void 0},rules:{title:[{required:!0,message:"请输入",trigger:"change"}]}}),h=b(),_=()=>{s.loading=!0,ie({keyword:s.keyword}).then(o=>{s.loading=!1,console.log(o),o.data.forEach((e,m)=>{e.index=m+1}),s.dataList=o.data}).catch(o=>{s.loading=!1,console.log(o)})},z=b({onChange:(o,e)=>{console.log(`selectedRowKeys: ${o}`,"selectedRows: ",e),s.selectedRowKeys=o}}),A=()=>{re(s.dataList,"订单信息.csv")},T=()=>{I(),a.visile=!0,a.editFlag=!1,a.title="新增";for(const o in a.form)a.form[o]=void 0},L=o=>{I(),a.visile=!0,a.editFlag=!0,a.title="编辑";for(const e in a.form)a.form[e]=void 0;for(const e in o)a.form[e]=o[e]},V=o=>{console.log("delete",o),H({ids:o.id}).then(e=>{_()}).catch(e=>{f.error(e.msg||"操作失败")})},B=()=>{if(console.log(s.selectedRowKeys),s.selectedRowKeys.length<=0){console.log("hello"),f.warn("请勾选删除项");return}H({ids:s.selectedRowKeys.join(",")}).then(o=>{f.success("删除成功"),s.selectedRowKeys=[],_()}).catch(o=>{f.error(o.msg||"操作失败")})},C=()=>{var o;(o=h.value)==null||o.validate().then(()=>{a.editFlag?me({order_id:a.form.id},a.form).then(e=>{k(),_()}).catch(e=>{console.log(e),f.error(e.msg||"操作失败")}):ce(a.form).then(e=>{k(),_()}).catch(e=>{console.log(e),f.error(e.msg||"操作失败")})}).catch(e=>{console.log("不能为空")})},Y=()=>{k()},I=()=>{var o;(o=h.value)==null||o.resetFields()},k=()=>{a.visile=!1};return(o,e)=>{const m=d("a-button"),N=d("a-input-search"),$=d("a-space"),E=d("a-divider"),j=d("a-popconfirm"),O=d("a-table"),g=d("a-input"),u=d("a-form-item"),p=d("a-col"),S=d("a-date-picker"),x=d("a-select-option"),q=d("a-select"),W=d("a-row"),X=d("a-form"),G=d("a-modal");return M(),R("div",null,[v("div",pe,[v("div",_e,[t($,null,{default:n(()=>[t(m,{type:"primary",onClick:A},{default:n(()=>[c("导出 CSV")]),_:1}),t(m,{type:"primary",onClick:T},{default:n(()=>[c("新增")]),_:1}),t(m,{onClick:B},{default:n(()=>[c("批量删除")]),_:1}),t(N,{"addon-before":"订单号","enter-button":"",onSearch:y,onChange:F})]),_:1})]),t(O,{size:"middle",rowKey:"id",loading:l(s).loading,columns:l(K),"data-source":l(s).dataList,scroll:{x:"max-content"},"row-selection":l(z),pagination:{size:"default",current:l(s).page,pageSize:l(s).pageSize,onChange:r=>l(s).page=r,showSizeChanger:!1,showTotal:r=>`共${r}条数据`}},{bodyCell:n(({text:r,record:D,index:ke,column:J})=>[J.key==="operation"?(M(),R("span",fe,[v("a",{onClick:P=>L(D)},"编辑",8,ve),t(E,{type:"vertical"}),t(j,{title:"确定删除?","ok-text":"是","cancel-text":"否",onConfirm:P=>V(D)},{default:n(()=>[ge]),_:2},1032,["onConfirm"])])):ne("",!0)]),_:1},8,["loading","columns","data-source","row-selection","pagination"])]),v("div",null,[t(G,{visible:l(a).visile,forceRender:!0,title:l(a).title,width:"880px","ok-text":"确认","cancel-text":"取消",onCancel:Y,onOk:C},{footer:n(()=>[t(m,{key:"back",onClick:Y},{default:n(()=>[c("取消")]),_:1}),t(m,{key:"submit",type:"primary",loading:l(U),onClick:C},{default:n(()=>[c("确认")]),_:1},8,["loading"])]),default:n(()=>[v("div",ye,[t(X,{ref_key:"myform",ref:h,"label-col":{style:{width:"80px"}},model:l(a).form,rules:l(a).rules},{default:n(()=>[t(W,{gutter:24},{default:n(()=>[t(p,{span:"24"},{default:n(()=>[t(u,{label:"商品 id",name:"product"},{default:n(()=>[t(g,{placeholder:"请输入",value:l(a).form.product,"onUpdate:value":e[0]||(e[0]=r=>l(a).form.product=r)},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"24"},{default:n(()=>[t(u,{label:"买家 id",name:"receiver"},{default:n(()=>[t(g,{placeholder:"请输入",value:l(a).form.merchant,"onUpdate:value":e[1]||(e[1]=r=>l(a).form.merchant=r)},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"24"},{default:n(()=>[t(u,{label:"卖家 id",name:"merchant"},{default:n(()=>[t(g,{placeholder:"请输入",value:l(a).form.receiver,"onUpdate:value":e[2]||(e[2]=r=>l(a).form.receiver=r)},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"24"},{default:n(()=>[t(u,{label:"金额"},{default:n(()=>[t(g,{placeholder:"请输入",value:l(a).form.amount,"onUpdate:value":e[3]||(e[3]=r=>l(a).form.amount=r)},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"12"},{default:n(()=>[t(u,{label:"生成时间"},{default:n(()=>[t(S,{"show-time":"",placeholder:"Select Time",value:l(a).form.create_time,"onUpdate:value":e[4]||(e[4]=r=>l(a).form.create_time=r),valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"12"},{default:n(()=>[t(u,{label:"支付时间"},{default:n(()=>[t(S,{"show-time":"",placeholder:"Select Time",value:l(a).form.pay_time,"onUpdate:value":e[5]||(e[5]=r=>l(a).form.pay_time=r),valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1})]),_:1}),t(p,{span:"8"},{default:n(()=>[t(u,{label:"状态",name:"status"},{default:n(()=>[t(q,{placeholder:"请选择",allowClear:"",value:l(a).form.status,"onUpdate:value":e[6]||(e[6]=r=>l(a).form.status=r)},{default:n(()=>[t(x,{key:"0",value:"0"},{default:n(()=>[c("未支付")]),_:1}),t(x,{key:"1",value:"1"},{default:n(()=>[c("已支付")]),_:1}),t(x,{key:"2",value:"2"},{default:n(()=>[c("订单取消")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["visible","title"])])])}}});const Ce=de(he,[["__scopeId","data-v-db046c91"]]);export{Ce as default};
