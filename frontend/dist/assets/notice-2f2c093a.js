import{j as H,I as y,d as J,a as h,z as b,k as P,r as i,o as I,b as R,e as m,l as n,x as c,E as S,y as Q,f as l,m as r,p as W,g as X}from"./index-68c43909.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z=async s=>H({url:"/myapp/admin/notice/list",params:s,data:{},headers:{}}),ee=async s=>y({url:"/myapp/admin/notice/create",params:{},data:s,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),te=async(s,u)=>y({url:"/myapp/admin/notice/update",params:s,data:u,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),z=async s=>y({url:"/myapp/admin/notice/delete",params:s,headers:{}}),oe=s=>(W("data-v-476bd603"),s=s(),X(),s),ae={class:"page-view"},ne={class:"table-operations"},le={key:0},se=["onClick"],ie=oe(()=>m("a",{href:"#"},"删除",-1)),ce=J({__name:"notice",setup(s){const u=h([{title:"序号",dataIndex:"index",key:"index",align:"center"},{title:"标题",dataIndex:"title",key:"title",align:"center"},{title:"内容",dataIndex:"content",key:"content",align:"center",customRender:({text:e,record:t,index:_,column:w})=>(e==null?void 0:e.substring(0,20))+"..."},{title:"操作",dataIndex:"action",key:"operation",align:"center",fixed:"right",width:140}]),a=h({noticeList:[],loading:!1,keyword:"",selectedRowKeys:[],pageSize:10,page:1}),o=h({visile:!1,editFlag:!1,title:"",form:{id:void 0,title:void 0},rules:{title:[{required:!0,message:"请输入",trigger:"change"}]}}),f=b();P(()=>{p()});const p=()=>{a.loading=!0,Z({keyword:a.keyword}).then(e=>{a.loading=!1,console.log(e),e.data.forEach((t,_)=>{t.index=_+1}),a.noticeList=e.data,a.loading=!1}).catch(e=>{a.loading=!1,console.log(e)})},K=b({onChange:(e,t)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",t),a.selectedRowKeys=e}}),A=()=>{v(),o.visile=!0,o.editFlag=!1,o.title="新增";for(const e in o.form)o.form[e]=void 0},F=e=>{v(),o.visile=!0,o.editFlag=!0,o.title="编辑";for(const t in o.form)o.form[t]=void 0;for(const t in e)o.form[t]=e[t]},B=e=>{console.log("delete",e),z({ids:e.id}).then(t=>{p()}).catch(t=>{r.error(t.msg||"操作失败")})},E=()=>{if(console.log(a.selectedRowKeys),a.selectedRowKeys.length<=0){console.log("hello"),r.warn("请勾选删除项");return}z({ids:a.selectedRowKeys.join(",")}).then(e=>{r.success("删除成功"),a.selectedRowKeys=[],p()}).catch(e=>{r.error(e.msg||"操作失败")})},L=()=>{var e;(e=f.value)==null||e.validate().then(()=>{o.editFlag?te({id:o.form.id},o.form).then(t=>{g(),p()}).catch(t=>{console.log(t),r.error(t.msg||"操作失败")}):ee(o.form).then(t=>{g(),p()}).catch(t=>{console.log(t),r.error(t.msg||"操作失败")})}).catch(t=>{console.log("不能为空")})},N=()=>{g()},v=()=>{var e;(e=f.value)==null||e.resetFields()},g=()=>{o.visile=!1};return(e,t)=>{const _=i("a-button"),w=i("a-space"),T=i("a-divider"),V=i("a-popconfirm"),$=i("a-table"),D=i("a-input"),k=i("a-form-item"),x=i("a-col"),M=i("a-textarea"),j=i("a-row"),O=i("a-form"),U=i("a-modal");return I(),R("div",null,[m("div",ae,[m("div",ne,[n(w,null,{default:c(()=>[n(_,{type:"primary",onClick:A},{default:c(()=>[S("新增")]),_:1}),n(_,{onClick:E},{default:c(()=>[S("批量删除")]),_:1})]),_:1})]),n($,{size:"middle",rowKey:"id",loading:l(a).loading,columns:l(u),"data-source":l(a).noticeList,scroll:{x:"max-content"},"row-selection":l(K),pagination:{size:"default",current:l(a).page,pageSize:l(a).pageSize,onChange:d=>l(a).page=d,showSizeChanger:!1,showTotal:d=>`共${d}条数据`}},{bodyCell:c(({text:d,record:C,index:de,column:q})=>[q.key==="operation"?(I(),R("span",le,[m("a",{onClick:G=>F(C)},"编辑",8,se),n(T,{type:"vertical"}),n(V,{title:"确定删除?","ok-text":"是","cancel-text":"否",onConfirm:G=>B(C)},{default:c(()=>[ie]),_:2},1032,["onConfirm"])])):Q("",!0)]),_:1},8,["loading","columns","data-source","row-selection","pagination"])]),m("div",null,[n(U,{visible:l(o).visile,forceRender:!0,title:l(o).title,"ok-text":"确认","cancel-text":"取消",onCancel:N,onOk:L},{default:c(()=>[m("div",null,[n(O,{ref_key:"myform",ref:f,"label-col":{style:{width:"80px"}},model:l(o).form,rules:l(o).rules},{default:c(()=>[n(j,{gutter:24},{default:c(()=>[n(x,{span:"24"},{default:c(()=>[n(k,{label:"标题",name:"title"},{default:c(()=>[n(D,{placeholder:"请输入标题",value:l(o).form.title,"onUpdate:value":t[0]||(t[0]=d=>l(o).form.title=d)},null,8,["value"])]),_:1})]),_:1}),n(x,{span:"24"},{default:c(()=>[n(k,{label:"通知内容",name:"content"},{default:c(()=>[n(M,{placeholder:"请输入内容",rows:4,value:l(o).form.content,"onUpdate:value":t[1]||(t[1]=d=>l(o).form.content=d)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["visible","title"])])])}}});const pe=Y(ce,[["__scopeId","data-v-476bd603"]]);export{pe as default};
