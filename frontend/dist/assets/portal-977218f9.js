import{F as B,H as P}from"./footer-1ce37bd7.js";import{j as R,u as q,h as H,a as j,k as M,B as k,r as g,o as c,b as i,e as o,l as _,f as n,F as S,n as w,q as $,t as p,s as N,x as O,y as X,p as G,g as J}from"./index-68c43909.js";import{l as C}from"./classification-7925674c.js";import{l as z}from"./canteen-54e19167.js";import{l as Q}from"./thing-333260d6.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./comment-13bad695.js";import"./logo_b-9bb82155.js";import"./avatar-4ee3f7af.js";const W=async d=>R({url:"/myapp/index/tag/list",params:d,data:{},headers:{}});const m=d=>(G("data-v-6b3788cc"),d=d(),J(),d),Y={class:"content"},Z={class:"content-left"},ee={class:"left-search-item"},te=m(()=>o("h4",null,"食堂列表",-1)),ae={class:"left-search-item"},se=m(()=>o("h4",null,"热门标签",-1)),oe={class:"tag-view tag-flex-view"},ne=["onClick"],le={class:"content-right"},ce={class:"top-select-view flex-view"},ie={class:"order-view"},de=m(()=>o("span",{class:"title"},null,-1)),re=["onClick"],ge={class:"pc-thing-list flex-view"},_e=["onClick"],he={class:"img-view"},pe=["src"],ue={class:"info-view"},fe={class:"thing-name"},ve={style:{color:"#444","font-size":"11px",height:"11px"}},ye=m(()=>o("br",null,null,-1)),me={style:{color:"#444","font-size":"11px",height:"11px"}},De={key:0,class:"no-data",style:{}},be={class:"page-view",style:{}},ke={__name:"content",setup(d){const x=q(),u=H(),e=j({selectX:0,selectTagId:-1,cData:[],bData:[],selectedKeys:[],tagData:[],loading:!1,tabData:["最新","必吃榜","推荐","食堂","柜台"],selectTabIndex:0,tabUnderLeft:12,thingData:[],pageData:[],value:[],page:1,total:0,pageSize:12});M(()=>{T(),y({})});const I=t=>new Promise(a=>{C({canteen:t.dataRef.id}).then(s=>{t.dataRef.children=[],s.data.forEach(r=>{r.key=`${t.eventKey}-${r.id}`,r.isLeaf=!0,t.dataRef.children.push(r)}),e.cData=[...e.cData],console.log(e.cData),a()})}),T=()=>{console.log(e),z().then(t=>{console.log("获取成功！！！！"),console.log(t),t.data.forEach(a=>{a.key=a.id,e.cData.push(a)})}),C().then(t=>{t.data.forEach(a=>{a.key=a.id,e.cData.push(a),e.bData.push(a)})}),W().then(t=>{e.tagData=t.data})},f=()=>e.selectedKeys.length>0?e.selectedKeys[0]:-1,D=()=>x.user_name,b=t=>{e.selectedKeys=[t[0].split("-")[1]],console.log("selectedKeys"),console.log(t),e.selectedKeys.length>0&&y({c:f()}),e.selectTagId=-1},K=t=>{e.selectedKeys=[],e.selectTagId=t,y({tag:e.selectTagId})},E=t=>{if(e.selectTabIndex=t,e.tabUnderLeft=12+50*t,t===3)F();else if(t===4)V();else{const s={sort:t===0?"recent":t===1?"hot":t===2?"recommend":t===3?"canteen":"classification"};e.selectTagId!==-1?s.tag=e.selectTagId:s.c=f(),s.username=D(),y(s)}},U=(t,a)=>{if(a<3){let s=u.resolve({name:"detail",query:{id:t.id}});window.open(s.href,"_blank")}else if(a===3){let s=u.resolve({name:"detailCanteen",query:{id:t.id}});window.open(s.href,"_blank")}else{let s=u.resolve({name:"detailCounter",query:{id:t.id}});window.open(s.href,"_blank")}},v=t=>{e.page=t;let a=(e.page-1)*e.pageSize;e.pageData=e.thingData.slice(a,a+e.pageSize),console.log("第"+e.page+"页")},F=()=>{e.loading=!0,z().then(t=>{e.loading=!1,t.data.forEach((a,s)=>{a.cover&&(a.cover=k+a.cover)}),console.log(t),e.thingData=t.data,e.total=e.thingData.length,v(1)}).catch(t=>{console.log(t),e.loading=!1})},V=()=>{e.loading=!0,C().then(t=>{e.loading=!1,t.data.forEach((a,s)=>{a.cover&&(a.cover=k+a.cover)}),console.log(t),e.thingData=t.data,e.total=e.thingData.length,v(1)}).catch(t=>{console.log(t),e.loading=!1})},y=t=>{console.log(t.username),e.loading=!0,Q(t).then(a=>{e.loading=!1,a.data.forEach((s,r)=>{s.cover&&(s.cover=k+s.cover)}),console.log(a),e.thingData=a.data,e.total=e.thingData.length,v(1)}).catch(a=>{console.log(a),e.loading=!1})};return(t,a)=>{const s=g("a-tree"),r=g("a-spin"),A=g("a-pagination");return c(),i("div",Y,[o("div",Z,[o("div",ee,[te,_(s,{"tree-data":n(e).cData,"selected-keys":n(e).selectedKeys,onSelect:b,"load-data":I,style:{"min-height":"220px"}},null,8,["tree-data","selected-keys"])]),o("div",ae,[se,o("div",oe,[(c(!0),i(S,null,w(n(e).tagData,l=>(c(),i("span",{class:$(["tag",{"tag-select":n(e).selectTagId===l.id}]),key:l.id,onClick:h=>K(l.id)},p(l.title),11,ne))),128))])])]),o("div",le,[o("div",ce,[o("div",ie,[de,(c(!0),i(S,null,w(n(e).tabData,(l,h)=>(c(),i("span",{class:$(["tab",n(e).selectTabIndex===h?"tab-select":""]),key:h,onClick:Ie=>E(h)},p(l),11,re))),128)),o("span",{style:N({left:n(e).tabUnderLeft+"px"}),class:"tab-underline"},null,4)])]),_(r,{spinning:n(e).loading,style:{"min-height":"200px"}},{default:O(()=>[o("div",ge,[(c(!0),i(S,null,w(n(e).pageData,l=>(c(),i("div",{key:l.id,onClick:h=>U(l,n(e).selectTabIndex),class:"thing-item item-column-3"},[o("div",he,[o("img",{src:l.cover},null,8,pe)]),o("div",ue,[o("h3",fe,p(l.title.substring(0,12)),1),o("span",ve,p(l.create_time.substring(0,16)),1),ye,o("span",me,p(l.pv)+"次浏览",1)])],8,_e))),128)),n(e).pageData.length<=0&&!n(e).loading?(c(),i("div",De,"暂无数据")):X("",!0)])]),_:1},8,["spinning"]),o("div",be,[_(A,{modelValue:n(e).page,"onUpdate:modelValue":a[0]||(a[0]=l=>n(e).page=l),size:"small",onChange:v,hideOnSinglePage:!0,defaultPageSize:n(e).pageSize,total:n(e).total,showSizeChanger:!1},null,8,["modelValue","defaultPageSize","total"])])])])}}},Se=L(ke,[["__scopeId","data-v-6b3788cc"]]),we={components:{Footer:B,Header:P,Content:Se},data(){return{}}},Ce={class:"portal"};function xe(d,x,u,e,I,T){const f=g("Header"),D=g("Content"),b=g("Footer");return c(),i("div",Ce,[_(f),_(D),_(b)])}const Ae=L(we,[["render",xe]]);export{Ae as default};
