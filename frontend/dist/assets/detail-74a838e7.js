import{u as le,z as i,a as ce,k as ie,B as U,m as p,o as a,b as d,l as H,e,f as l,t as c,y as b,F as S,n as R,q as z,w as ae,v as de,A as re,h as _e,C as ue,p as ve,g as he}from"./index-68c43909.js";import{H as me,F as pe}from"./footer-1ce37bd7.js";import{R as ge,S as fe,W as we}from"./emoji-78e8751b.js";import{A as B}from"./avatar-4ee3f7af.js";import{d as be,l as ke,a as xe,b as Ce}from"./thing-333260d6.js";import{l as N,c as j,a as ye}from"./comment-13bad695.js";import{_ as Ie}from"./_plugin-vue_export-helper-c27b6911.js";import"./logo_b-9bb82155.js";const $e="/assets/want-read-hover-e9e227e2.svg";const u=k=>(ve("data-v-8681217a"),k=k(),he(),k),Se={class:"detail"},Re={class:"detail-content"},Ae={class:"detail-content-top"},De={style:{position:"relative"}},Te={class:"thing-infos-view"},Ue={class:"thing-infos"},ze=["src"],Be={class:"title"},Le={class:"meta"},We={class:"desc"},Ee={class:"thing-counts hidden-sm"},Fe={class:"count-img"},Me=["src"],Ve={class:"count-box flex-view"},qe=u(()=>e("div",{class:"count-text-box"},[e("span",{class:"count-title"},"收藏")],-1)),He={class:"count-num-box"},Ne={class:"num-text"},je={class:"count-img"},Pe=["src"],Ge={class:"count-box flex-view"},Je=u(()=>e("div",{class:"count-text-box"},[e("span",{class:"count-title"},"吃过")],-1)),Ke={class:"count-num-box"},Oe={class:"num-text"},Qe={class:"count-img"},Xe=["src"],Ye={class:"count-box flex-view"},Ze=u(()=>e("div",{class:"count-text-box"},[e("span",{class:"count-title"},"分享")],-1)),es={class:"count-num-box"},ss=u(()=>e("span",{class:"num-text"},null,-1)),ts=["src"],os={key:0,style:{"margin-top":"24px"}},ns=u(()=>e("img",{style:{width:"250px",height:"100px","background-size":"cover","object-fit":"cover"},src:""},null,-1)),ls=[ns],cs={class:"detail-content-bottom"},is={class:"thing-content-view flex-view"},as={class:"main-content"},ds={class:"order-view main-tab"},rs=["onClick"],_s={class:"thing-comment"},us=u(()=>e("div",{class:"title"},"发表新的评论",-1)),vs={class:"publish flex-view"},hs=["src"],ms={class:"tab-view flex-view"},ps={class:"count-text"},gs={key:0,class:"tab-box flex-view"},fs=u(()=>e("div",{class:"line"},null,-1)),ws={class:"comments-list"},bs={class:"comment-item"},ks={class:"flex-item flex-view"},xs=["src","onClick"],Cs={class:"person"},ys={class:"name"},Is={class:"time"},$s={class:"float-right"},Ss=["onClick"],Rs=["onClick"],As={class:"num"},Ds={class:"comment-content"},Ts={key:0},Us={class:"publish flex-view"},zs={class:"count-text"},Bs=["onClick"],Ls={key:0},Ws={class:"comment-item-sub"},Es={class:"flex-item flex-view"},Fs=["src","onClick"],Ms={class:"person"},Vs={class:"name"},qs={class:"time"},Hs={class:"float-right"},Ns=["onClick"],js=["onClick"],Ps={class:"num"},Gs={class:"comment-content-sub"},Js={key:1,class:"publish flex-view"},Ks=["placeholder"],Os=["onClick"],Qs=u(()=>e("div",{class:"infinite-loading-container"},[e("div",{class:"infinite-status-prompt",style:{}},[e("div",{slot:"no-results",class:"no-results"},[e("div"),e("p",null,"没有更多了")])])],-1)),Xs={class:"recommend",style:{}},Ys=u(()=>e("div",{class:"title"},"热门推荐",-1)),Zs={class:"things"},et=["onClick"],st={class:"img-view"},tt=["src"],ot={class:"info-view"},nt={class:"thing-name"},lt={style:{color:"#444","font-size":"11px",height:"11px"}},ct=u(()=>e("br",null,null,-1)),it={style:{color:"#444","font-size":"11px",height:"11px"}},at={__name:"detail",setup(k){const A=_e(),P=ue(),x=le();let G=i(),m=i(""),r=i({}),J=i(6),K=i(["评论"]),L=i(0),_=i([]),W=i([]),C=i(0),D=i("recent"),y=i();ce({});let E=i(),v=i(new Map),F=i(-1),M=i(-1);const g=i("");let I=i(""),f=i(new Map);const $=(s,o)=>{if(v.value.has(s)||v.value.set(s,!1),console.log(v.value.get(s)),F.value==s&&M.value!=o||v.value.set(s,!v.value.get(s)),v.value.get(s)){if(g.value="",s==o){const t=_.value.filter(n=>n.id==o);I.value="@"+t[0].username+": ",console.log(t[0]),console.log(t[0].username)}else{const t=_.value.filter(h=>h.id==s);console.log(t[0]);const n=t[0].replies.data.filter(h=>h.id==o);I.value="@"+n[0].username+": ",console.log(n[0]),console.log(n[0].username)}for(const t in _.value)console.log(_.value[t].id),_.value[t].id!=s&&v.value.set(_.value[t].id,!1)}F.value=s,M.value=o},O=s=>{f.value.has(s)||f.value.set(s,!1),f.value.set(s,!f.value.get(s))};ie(()=>{m.value=P.query.id.trim(),T(),ee(),w();for(const s in _.value)v.value.set(s,!1),f.value.set(s,!1)});const Q=s=>{L.value=s,J.value=6+54*s},T=()=>{E=r.value.raw==null,console.log(E),be({id:m.value}).then(s=>{r.value=s.data,r.value.cover=U+s.data.cover,r.value.raw=U+r.value.raw}).catch(s=>{p.error("获取详情失败")})},X=()=>{let s=x.user_name;s?xe({thingId:m.value,username:s}).then(o=>{p.success(o.msg),T()}).catch(o=>{console.log("操作失败")}):p.warn("请先登录")},Y=()=>{let s=x.user_name;s?(console.log(m.value),Ce({thingId:m.value,username:s}).then(o=>{p.success(o.msg),T()}).catch(o=>{console.log("收藏菜肴失败")})):p.warn("请先登录")},Z=()=>{let o="http://service.weibo.com/share/share.php?title="+("分享一个非常好玩的网站 "+window.location.href);window.open(o)},ee=()=>{ke({sort:"recommend"}).then(s=>{s.data.forEach((o,t)=>{o.cover&&(o.cover=U+o.cover)}),console.log(s),console.log(r),W.value=s.data.slice(0,6)}).catch(s=>{console.log(s)})},se=s=>{let o=A.resolve({name:"detail",query:{id:s.id}});window.open(o.href,"_blank")},te=()=>{console.log(y.value.value);let s=y.value.value.trim();if(console.log(s),s.length<=0)return;y.value.value="";let o=x.user_id;o?j({content:s,thing:m.value,user:o},{}).then(t=>{w()}).catch(t=>{console.log(t)}):(p.warn("请先登录！"),A.push({name:"login"}))},oe=s=>{let o=I.value+g.value.trim();if(console.log(o),o.length<=0)return;g.value="";let t=x.user_id;t?j({content:o,thing:m.value,user:t},{parentId:s}).then(n=>{w()}).catch(n=>{console.log(n)}):(p.warn("请先登录！"),A.push({name:"login"}))},V=s=>{ye({commentId:s}).then(o=>{w()}).catch(o=>{console.log(o)})},w=()=>{N({thingId:m.value,order:D.value}).then(s=>{const o=[...s.data],t=o.map(n=>N({parentId:n.id,order:D.value}));return Promise.all(t).then(n=>{n.forEach((h,ne)=>{o[ne].replies=h}),_.value=o,console.log(_.value)}).catch(n=>{console.log(n)})}).catch(s=>{console.log(s)})},q=s=>{s==="recent"?C.value=0:C.value=1,D.value=s,w()};return(s,o)=>(a(),d("div",Se,[H(me),e("div",Re,[e("div",Ae,[e("div",De,[e("div",Te,[e("div",Ue,[e("img",{src:l(r).cover,width:"800",height:"500"},null,8,ze),e("div",Be,c(l(r).title),1),e("div",Le,c(l(r).pv)+"次浏览",1),e("div",We,"简介："+c(l(r).description),1)]),e("div",Ee,[e("div",{class:"count-item flex-view pointer",onClick:o[0]||(o[0]=t=>Y())},[e("div",Fe,[e("img",{src:l(ge)},null,8,Me)]),e("div",Ve,[qe,e("div",He,[e("span",Ne,c(l(r).collect_count),1)])])]),e("div",{class:"count-item flex-view pointer",onClick:o[1]||(o[1]=t=>X())},[e("div",je,[e("img",{src:l($e)},null,8,Pe)]),e("div",Ge,[Je,e("div",Ke,[e("span",Oe,c(l(r).wish_count),1)])])]),e("div",{class:"count-item flex-view",onClick:o[2]||(o[2]=t=>Z())},[e("div",Qe,[e("img",{src:l(fe)},null,8,Xe)]),e("div",Ye,[Ze,e("div",es,[ss,e("img",{src:l(we),class:"mg-l"},null,8,ts)])])]),l(G)?(a(),d("div",os,ls)):b("",!0)])])])]),e("div",cs,[e("div",is,[e("div",as,[e("div",ds,[(a(!0),d(S,null,R(l(K),(t,n)=>(a(),d("span",{class:z(["tab",l(L)===n?"tab-select":""]),key:n,onClick:h=>Q(n)},c(t),11,rs))),128))]),e("div",_s,[us,e("div",vs,[e("img",{src:l(B),class:"mine-img"},null,8,hs),e("textarea",{placeholder:"说点什么...",class:"content-input",ref_key:"commentRef",ref:y},null,512),e("button",{class:"send-btn",onClick:o[3]||(o[3]=t=>te())},"发送")]),e("div",ms,[e("div",ps,"共有"+c(l(_).length)+"条评论",1),l(_).length>0?(a(),d("div",gs,[e("span",{class:z(l(C)===0?"tab-select":""),onClick:o[4]||(o[4]=t=>q("recent"))},"最新",2),fs,e("span",{class:z(l(C)===1?"tab-select":""),onClick:o[5]||(o[5]=t=>q("hot"))},"热门",2)])):b("",!0)]),e("div",ws,[(a(!0),d(S,null,R(l(_),t=>(a(),d("div",bs,[e("div",ks,[e("img",{src:l(B),class:"avator",onClick:n=>$(t.id,t.id)},null,8,xs),e("div",Cs,[e("div",ys,c(t.username),1),e("div",Is,c(t.comment_time),1)]),e("div",$s,[e("span",{onClick:n=>$(t.id,t.id)},"回复",8,Ss),e("span",{onClick:n=>V(t.id)},"点赞",8,Rs),e("span",As,c(t.like_count),1)])]),e("p",Ds,c(t.content),1),t.reply_count>0?(a(),d("div",Ts,[e("div",Us,[e("div",zs,[e("span",null,"共有"+c(t.reply_count)+"条回复，",1),e("span",{class:"more-btn-sub",onClick:n=>O(t.id)},"点击查看",8,Bs)])]),l(f).get(t.id)?(a(),d("div",Ls,[(a(!0),d(S,null,R(t.replies.data,n=>(a(),d("div",Ws,[e("div",Es,[e("img",{src:l(B),class:"avator",onClick:h=>$(t.id,n.id)},null,8,Fs),e("div",Ms,[e("div",Vs,c(n.username),1),e("div",qs,c(n.comment_time),1)]),e("div",Hs,[e("span",{onClick:h=>$(t.id,n.id)},"回复",8,Ns),e("span",{onClick:h=>V(n.id)},"推荐",8,js),e("span",Ps,c(n.like_count),1)])]),e("p",Gs,c(n.content),1)]))),256))])):b("",!0)])):b("",!0),l(v).get(t.id)?(a(),d("div",Js,[ae(e("textarea",{placeholder:l(I),class:"content-input-sub","onUpdate:modelValue":o[6]||(o[6]=n=>re(g)?g.value=n:null)},null,8,Ks),[[de,l(g)]]),e("button",{class:"send-btn-sub",onClick:n=>oe(t.id)},"发送",8,Os)])):b("",!0)]))),256)),Qs])])]),e("div",Xs,[Ys,e("div",Zs,[(a(!0),d(S,null,R(l(W),t=>(a(),d("div",{key:t.id,onClick:n=>se(t),class:"thing-item item-column-3"},[e("div",st,[e("img",{src:t.cover},null,8,tt)]),e("div",ot,[e("h3",nt,c(t.title.substring(0,12)),1),e("span",lt,c(t.create_time.substring(0,16)),1),ct,e("span",it,c(t.pv)+"次浏览",1)])],8,et))),128))])])])])]),H(pe)]))}},gt=Ie(at,[["__scopeId","data-v-8681217a"]]);export{gt as default};
