import{s as X,u as Y,z as Z,r as c,A as ee,H as $,l as O,b as y,o as i,n as p,g as b,f as a,e,i as t,q as N,C as m,t as n,j as u,c as B,p as te,k as ae}from"./index-e9b87848.js";import{g as z}from"./order-6d7ee45b.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";const oe=x=>(te("data-v-5bcee5b9"),x=x(),ae(),x),ne={class:"content-list"},le=oe(()=>b("div",{class:"list-title"},"我的订单",-1)),ie={class:"list-content"},ue={class:"comment-view"},ce={key:0},_e=["onClick"],re=["onClick"],de={key:2},pe={key:3},me=["onClick"],ye=["onClick"],ve={key:0},ke=["onClick"],be=["onClick"],fe={key:2},he={key:3},ge=["onClick"],Ce={__name:"thingHistory",setup(x){const v=X(),C=Y(),T=Z();c(!1),c(!1),c(!1);const k=c(!1),f=c(0);c(-1);const I=c(!1),q=c(!1),H=c([]),S=c([]),D=c("1");let _=c({}),r=c({});const j=[{name:"商品名",dataIndex:"product_name",key:"product_name"},{title:"卖家",dataIndex:"merchant_name",key:"merchant_name"},{title:"订单状态",dataIndex:"status",key:"status"},{title:"支付金额",key:"amount",dataIndex:"amount"},{title:"操作",key:"action"}],E=[{name:"商品名",dataIndex:"product_name",key:"product_name"},{title:"买家",dataIndex:"receiver_name",key:"receiver_name"},{title:"订单状态",dataIndex:"status",key:"status"},{title:"支付金额",key:"amount",dataIndex:"amount"},{title:"操作",key:"action"}];ee(()=>{$().query.id?$().query.id.trim()!==String(C.user_id)&&v.push({name:"wishThingView",query:{id:$().query.id.trim()}}):v.push({name:"scoreView",query:{id:C.user_id}}),T.setViewId(C.user_id),M(),F()});const M=()=>{k.value=!0,f.value++,C.user_id,z({user_type:"receiver"}).then(l=>{console.log(l.data),H.value=l.data,k.value=--f.value!==0}).catch(l=>{O({type:"error",message:"Oops!",description:"获取购买列表失败！"}),k.value=--f.value!==0})},F=()=>{k.value=!0,f.value++,C.user_id,z({user_type:"merchant"}).then(l=>{S.value=l.data,k.value=--f.value!==0,console.log(S.value)}).catch(l=>{O({type:"error",message:"Oops!",description:"获取卖出列表失败！"}),k.value=--f.value!==0})},K=()=>{O({type:"error",message:"Oops!",description:"普通用户不允许删除订单记录！"})},G=l=>{console.log(l.value),v.push({name:"purchase",query:{product:l.id,order_number:l.order_number}})},J=l=>{_=l,console.log(_),I.value=!0},P=l=>{r=l,console.log(r),q.value=!0};return(l,h)=>{const w=y("a-tag"),V=y("a-divider"),R=y("a-table"),d=y("a-descriptions-item"),U=y("a-descriptions"),A=y("a-modal"),L=y("a-tab-pane"),Q=y("a-tabs"),W=y("a-spin");return i(),p("div",ne,[le,b("div",ie,[b("div",ue,[a(W,{spinning:t(k),style:{"min-height":"200px"}},{default:e(()=>[a(Q,{activeKey:t(D),"onUpdate:activeKey":h[2]||(h[2]=o=>N(D)?D.value=o:null),animated:"",size:"large",type:"card"},{default:e(()=>[a(L,{key:"1",tab:"我买到的"},{default:e(()=>[a(R,{columns:j,"data-source":t(H)},{headerCell:e(({column:o})=>[o.key==="product_name"?(i(),p("span",ce,"商品名")):m("",!0)]),bodyCell:e(({column:o,record:s})=>[o.key==="product_name"?(i(),p("a",{key:0,onClick:g=>t(v).push({name:"detail",query:{id:s.product}})},n(s.product_name),9,_e)):m("",!0),o.key==="merchant_name"?(i(),p("a",{key:1,onClick:g=>t(v).push({name:"usercenter",query:{id:s.merchant}})},n(s.merchant_name),9,re)):o.key==="status"?(i(),p("span",de,[a(w,{color:s.status==="0"?"geekblue":s.status==="1"?"green":"volcano"},{default:e(()=>[u(n(s.status==="0"?"等待支付":s.status==="1"?"支付成功":"订单已取消"),1)]),_:2},1032,["color"])])):o.key==="action"?(i(),p("span",pe,[s.status==="0"?(i(),p("a",{key:0,onClick:g=>G(s)},"前往支付",8,me)):m("",!0),s.status==="0"?(i(),B(V,{key:1,type:"vertical"})):m("",!0),b("a",{onClick:g=>J(s)},"查看订单详情",8,ye),a(V,{type:"vertical"}),b("a",{onClick:K},"删除订单记录")])):m("",!0)]),_:1},8,["data-source"]),a(A,{visible:t(I),"onUpdate:visible":h[0]||(h[0]=o=>N(I)?I.value=o:null)},{footer:e(()=>[]),default:e(()=>[a(U,{title:"订单详情",bordered:"",column:1},{default:e(()=>[a(d,{label:"商品名"},{default:e(()=>[u(n(t(_).product_name),1)]),_:1}),a(d,{label:"发布者"},{default:e(()=>[u(n(t(_).merchant_name),1)]),_:1}),a(d,{label:"订单提交时间"},{default:e(()=>[u(n(t(_).create_time),1)]),_:1}),t(_).status==="1"?(i(),B(d,{key:0,label:"订单支付时间"},{default:e(()=>[u(n(t(_).pay_time),1)]),_:1})):m("",!0),a(d,{label:"订单状态"},{default:e(()=>[a(w,{color:t(_).status==="0"?"geekblue":t(_).status==="1"?"green":"volcano"},{default:e(()=>[u(n(t(_).status==="0"?"等待支付":t(_).status==="1"?"支付成功":"订单已取消"),1)]),_:1},8,["color"])]),_:1}),a(d,{label:"订单号"},{default:e(()=>[u(n(t(_).order_number),1)]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1}),a(L,{key:"2",tab:"我卖出的"},{default:e(()=>[a(R,{columns:E,"data-source":t(S)},{headerCell:e(({column:o})=>[o.key==="product_name"?(i(),p("span",ve,"商品名")):m("",!0)]),bodyCell:e(({column:o,record:s})=>[o.key==="product_name"?(i(),p("a",{key:0,onClick:g=>t(v).push({name:"detail",query:{id:s.product}})},n(s.product_name),9,ke)):m("",!0),o.key==="receiver_name"?(i(),p("a",{key:1,onClick:g=>t(v).push({name:"usercenter",query:{id:s.receiver}})},n(s.receiver_name),9,be)):o.key==="status"?(i(),p("span",fe,[a(w,{color:s.status==="0"?"geekblue":s.status==="1"?"green":"volcano"},{default:e(()=>[u(n(s.status==="0"?"等待支付":s.status==="1"?"支付成功":"订单已取消"),1)]),_:2},1032,["color"])])):o.key==="action"?(i(),p("span",he,[b("a",{onClick:g=>P(s)},"查看订单详情",8,ge),a(V,{type:"vertical"}),b("a",{onClick:K},"删除订单记录")])):m("",!0)]),_:1},8,["data-source"]),a(A,{visible:t(q),"onUpdate:visible":h[1]||(h[1]=o=>N(q)?q.value=o:null)},{footer:e(()=>[]),default:e(()=>[a(U,{title:"订单详情",bordered:"",column:1},{default:e(()=>[a(d,{label:"商品名"},{default:e(()=>[u(n(t(r).product_name),1)]),_:1}),a(d,{label:"购买者"},{default:e(()=>[u(n(t(r).receiver_name),1)]),_:1}),a(d,{label:"订单提交时间"},{default:e(()=>[u(n(t(r).create_time),1)]),_:1}),t(r).status==="1"?(i(),B(d,{key:0,label:"订单支付时间"},{default:e(()=>[u(n(t(r).pay_time),1)]),_:1})):m("",!0),a(d,{label:"订单状态"},{default:e(()=>[a(w,{color:t(r).status==="0"?"geekblue":t(r).status==="1"?"green":"volcano"},{default:e(()=>[u(n(t(r).status==="0"?"等待支付":t(r).status==="1"?"支付成功":"订单已取消"),1)]),_:1},8,["color"])]),_:1}),a(d,{label:"订单号"},{default:e(()=>[u(n(t(r).order_number),1)]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1})]),_:1},8,["activeKey"])]),_:1},8,["spinning"])])])])}}},we=se(Ce,[["__scopeId","data-v-5bcee5b9"]]);export{we as default};
