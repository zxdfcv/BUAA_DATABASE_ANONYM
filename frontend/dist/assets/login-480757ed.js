import{d as L,u as T,r as b,a as U,w as A,b as m,o as M,c as B,e as d,f as s,g as r,h as E,i as o,j as N,p as R,k as V,l as x,m as K,n as Z,q as Q,s as X,t as Y,v as q,x as W,y as ee}from"./index-6d07a472.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";const te=e=>(R("data-v-d7552af7"),e=e(),V(),e),oe=te(()=>r("div",{style:{"text-align":"left","font-size":"14px","margin-bottom":"30px"}},[r("b",null,"北航二手交易平台")],-1)),se={class:"login"},ne={style:{float:"right"}},ae=L({__name:"LoginView",props:["display"],setup(e){const t=e,a=T(),u={username:[{required:!0,message:"Please input Activity name",trigger:"change"},{min:5,max:15,message:"Length should be 5 to 15",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"change"},{min:6,max:16,message:"Length should be 6 to 16",trigger:"blur"}]},c=b(!1),n=U({username:"",password:"",remember:!1}),_=()=>{a.remember_me===!0&&(n.username=a.user_name,n.remember=a.remember_me)},w=()=>{console.log(t.display),c.value=!0,a.login({username:n.username,password:n.password}).then(l=>{c.value=!1,x({type:"success",message:"登录成功！",description:"你好，"+(a.is_admin?"管理员":"用户")+" "+l.data.username+"！"}),a.remember_me=n.remember,K.push({name:"portal"})}).catch(l=>{console.log(l),c.value=!1,x({type:"error",message:"Oops!",description:l.response.data.msg})})};return A(()=>t.display,()=>{console.log("filling"),_()}),_(),(l,g)=>{const S=m("a-input"),C=m("a-form-item"),I=m("a-input-password"),P=m("a-checkbox"),z=m("a-col"),p=m("a-button"),i=m("a-form"),f=m("el-card"),h=m("a-spin");return M(),B(h,{spinning:o(c)},{default:d(()=>[s(f,{bordered:!1,shadow:"hover",style:{top:"5%",left:"auto","background-color":"#f9f9f9",height:"auto"}},{default:d(()=>[oe,r("div",se,[s(i,{onSubmit:E(w,["prevent"]),rules:u,model:o(n),class:"login-form sign-in-form"},{default:d(()=>[s(C,{label:"用户名",name:"username"},{default:d(()=>[s(S,{value:o(n).username,"onUpdate:value":g[0]||(g[0]=y=>o(n).username=y)},null,8,["value"])]),_:1}),s(C,{label:"密码",name:"password"},{default:d(()=>[s(I,{value:o(n).password,"onUpdate:value":g[1]||(g[1]=y=>o(n).password=y)},null,8,["value"])]),_:1}),s(z,{class:"gutter-row",span:8,style:{"margin-top":"10px"}},{default:d(()=>[s(C,{name:"remember"},{default:d(()=>[s(P,{checked:o(n).remember,"onUpdate:checked":g[2]||(g[2]=y=>o(n).remember=y)},{default:d(()=>[N("Remember me")]),_:1},8,["checked"])]),_:1})]),_:1}),s(C,null,{default:d(()=>[s(p,{loading:o(c),style:{width:"100%","margin-top":"4px"},size:"large",htmlType:"submit",type:"primary"},{default:d(()=>[N(" 登录 ")]),_:1},8,["loading"])]),_:1}),r("div",ne,[N(" 或者 "),r("a",{onClick:g[3]||(g[3]=y=>l.$emit("toRegister"))},"去注册")])]),_:1},8,["onSubmit","model"])])]),_:1})]),_:1},8,["spinning"])}}});const re=$(ae,[["__scopeId","data-v-d7552af7"]]);const ie={name:"SIdentify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:31}},methods:{randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},randomColor(e,t){let a=this.randomNum(e,t),u=this.randomNum(e,t),c=this.randomNum(e,t);return"rgb("+a+","+u+","+c+")"},drawPic(){let t=document.getElementById("s-canvas").getContext("2d");t.textBaseline="bottom",t.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),t.fillRect(0,0,this.contentWidth,this.contentHeight);for(let a=0;a<this.identifyCode.length;a++)this.drawText(t,this.identifyCode[a],a);this.drawLine(t),this.drawDot(t)},drawText(e,t,a){e.fillStyle=this.randomColor(this.colorMin,this.colorMax),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let u=(a+1)*(this.contentWidth/(this.identifyCode.length+1)),c=this.randomNum(this.fontSizeMax,this.contentHeight-5);var n=this.randomNum(-45,45);e.translate(u,c),e.rotate(n*Math.PI/180),e.fillText(t,0,0),e.rotate(-n*Math.PI/180),e.translate(-u,-c)},drawLine(e){for(let t=0;t<5;t++)e.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),e.beginPath(),e.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.stroke()},drawDot(e){for(let t=0;t<80;t++)e.fillStyle=this.randomColor(0,255),e.beginPath(),e.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),e.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},le={class:"s-canvas"},de=["width","height"];function ue(e,t,a,u,c,n){return M(),Z("div",le,[r("canvas",{id:"s-canvas",width:a.contentWidth,height:a.contentHeight},null,8,de)])}const me=$(ie,[["render",ue],["__scopeId","data-v-9ce5c420"]]),D=e=>(R("data-v-3ecfead6"),e=e(),V(),e),pe=D(()=>r("div",{style:{"text-align":"left","font-size":"14px","margin-bottom":"30px"}},[r("b",null,"北航二手交易平台")],-1)),ce={class:"login"},_e=D(()=>r("p",{style:{"margin-top":"5px"}},"验证码:",-1)),fe={style:{float:"right"}},ge=L({__name:"RegisterView",emits:["toLogin"],setup(e,{emit:t}){const a=T(),u=b(!1),c=Object.freeze({}),n="1234567890",_=b(""),w=b(""),l=U({username:"",password:"",confirm_password:"",email:""}),g=(p,i)=>Math.floor(Math.random()*(i-p)+p),S=p=>{for(let i=0;i<p;i++)_.value+=n[g(0,n.length)]},C=()=>{_.value="",S(4)},I=(p,i,f)=>{if(!/(?=.*[0-9])(?=.*[a-zA-Z])/.test(i)){f("密码必须包含数字和字母");return}f()},P=(p,i,f)=>{let h=l.password;i&&h&&i.trim()!==h.trim()&&f(new Error("两次输入的密码不一致")),f()},z=()=>{if(console.log(l),w.value==="")return x({message:"Error",description:"Please input identify code.",type:"error"}),!1;if(w.value!==_.value)return x({message:"Error",description:"Identify code error.",type:"error"}),_.value="",C(),!1;u.value=!0,a.register({username:l.username,password:l.password,confirm_password:l.confirm_password,email:l.email}).then(p=>{u.value=!1,x({type:"success",message:"注册成功！",description:"用户 "+p.data.user.username+" 创建成功！"}),a.remember_me=!0,t("toLogin")}).catch(p=>{console.log(p),u.value=!1,x({type:"error",message:"Oops!",description:p.response.data.msg})})};return _.value="",S(4),(p,i)=>{const f=m("a-input"),h=m("a-form-item"),y=m("a-input-password"),H=m("a-col"),j=m("a-row"),O=m("a-button"),F=m("a-form"),G=m("el-card"),J=m("a-spin");return M(),B(J,{spinning:o(u)},{default:d(()=>[s(G,{bordered:!1,shadow:"hover",style:{top:"5%",left:"auto","background-color":"#f9f9f9",height:"auto"}},{default:d(()=>[pe,r("div",ce,[s(F,{onSubmit:E(z,["prevent"]),rules:o(c),model:o(l),class:"register-form sign-up-form"},{default:d(()=>[s(h,{label:"用户名",name:"username",rules:[{required:!0,message:"Please input username"},{min:5,max:15,message:"长度需要介于 5~15 个字符"}]},{default:d(()=>[s(f,{value:o(l).username,"onUpdate:value":i[0]||(i[0]=v=>o(l).username=v),autocomplete:"off"},null,8,["value"])]),_:1}),s(h,{label:"密码",name:"password",rules:[{required:!0,message:"Please input password"},{min:6,max:16,message:"长度需要介于 6~16 个字符"},{validator:I}]},{default:d(()=>[s(y,{value:o(l).password,"onUpdate:value":i[1]||(i[1]=v=>o(l).password=v),autocomplete:"off"},null,8,["value"])]),_:1},8,["rules"]),s(h,{label:"重复密码",name:"confirm_password",rules:[{required:!0,message:"Please repeat password"},{min:6,max:16,message:"长度需要介于 6~16 个字符"},{validator:P}]},{default:d(()=>[s(y,{value:o(l).confirm_password,"onUpdate:value":i[2]||(i[2]=v=>o(l).confirm_password=v),autocomplete:"off"},null,8,["value"])]),_:1},8,["rules"]),s(h,{label:"注册邮箱",name:"email",rules:[{required:!0,message:"Please input email"},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"无效的邮箱格式"}]},{default:d(()=>[s(f,{value:o(l).email,"onUpdate:value":i[3]||(i[3]=v=>o(l).email=v),autocomplete:"off"},null,8,["value"])]),_:1},8,["rules"]),s(j,{gutter:10,justify:"start"},{default:d(()=>[s(H,{class:"gutter-row",span:8,onClick:C},{default:d(()=>[s(me,{identifyCode:o(_)},null,8,["identifyCode"])]),_:1}),_e,s(H,{class:"gutter-row",span:4,offset:1},{default:d(()=>[s(f,{value:o(w),"onUpdate:value":i[4]||(i[4]=v=>Q(w)?w.value=v:null)},null,8,["value"])]),_:1})]),_:1}),s(h,null,{default:d(()=>[s(O,{loading:o(u),style:{width:"100%","margin-top":"4px"},size:"large",htmlType:"submit",type:"primary"},{default:d(()=>[N(" 注册 ")]),_:1},8,["loading"])]),_:1}),r("div",fe,[N(" 已有账号？ "),r("a",{onClick:i[5]||(i[5]=v=>p.$emit("toLogin"))},"去登陆")])]),_:1},8,["onSubmit","rules","model"])])]),_:1})]),_:1},8,["spinning"])}}});const he=$(ge,[["__scopeId","data-v-3ecfead6"]]),k=e=>(R("data-v-9beb9a80"),e=e(),V(),e),ve={class:"form-container"},ye={class:"signin-signup"},be={class:"panels-container"},we={class:"panel left-panel"},Ce={class:"content"},xe=k(()=>r("h3",{style:{color:"#fff"}},"北航二手交易平台",-1)),Ne=k(()=>r("p",null,"欢迎使用",-1)),Se={class:"panel right-panel"},Me={class:"content"},$e=k(()=>r("h3",{style:{color:"#fff"}},"北航二手交易平台",-1)),ke=k(()=>r("p",null,"开始使用",-1)),Ie=L({__name:"login",setup(e){X(),T(),U({loginForm:{username:"",password:""}});const t=b(!1);b(!0);const a=b(!0),u=b("登录");return A(t,()=>{setTimeout(()=>{},600),setTimeout(()=>{u.value==="登录"?u.value="注册":u.value="登录",a.value=!a.value},1100)}),(c,n)=>(M(),Z("div",{class:ee(["container",{"sign-up-mode":o(t)}]),style:{width:"100%"}},[r("div",ve,[r("div",ye,[r("h1",null,Y(o(u)),1),q(s(re,{onToRegister:n[0]||(n[0]=_=>t.value=!o(t)),display:o(a),style:{margin:"15px",width:"85%"},class:"content"},null,8,["display"]),[[W,o(a)]]),q(s(he,{onToLogin:n[1]||(n[1]=_=>t.value=!o(t)),style:{margin:"15px",width:"85%"},class:"content"},null,512),[[W,!o(a)]])])]),r("div",be,[r("div",we,[r("div",Ce,[xe,Ne,r("button",{onClick:n[2]||(n[2]=_=>t.value=!o(t)),class:"btn transparent"}," 去注册 ")])]),r("div",Se,[r("div",Me,[$e,ke,r("button",{onClick:n[3]||(n[3]=_=>t.value=!o(t)),class:"btn transparent"}," 去登录 ")])])])],2))}});const Le=$(Ie,[["__scopeId","data-v-9beb9a80"]]);export{Le as default};
